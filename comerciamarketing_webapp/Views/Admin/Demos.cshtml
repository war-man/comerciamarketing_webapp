@model List<comerciamarketing_webapp.Models.Demos>
@{
    ViewBag.title = "Comercia Marketing - Admin Demos";
}

<!-- ############ Content START-->
<div id="content" class="flex ">
    <div class="page-hero page-container " id="page-hero">
        <div class="padding d-flex">
            <div class="page-title">
                <h2 class="text-md text-highlight">Demos</h2>
                <small class="text-muted">
                    Manage all Demos for
                    <strong> Vendors Brands</strong>
                </small>
            </div>
            <div class="flex"></div>
            <div>
                <button data-toggle="modal" data-target="#createModal" class="btn btn-sm box-shadows btn-rounded gd-primary">
                    Add Demo
                </button>
            </div>
        </div>
        <div class="d-flex flex">

            <div class="d-flex flex" id="content-body">
                <div class="d-flex flex-column flex" id="mail-list" data-plugin="mail">

                    <div class="p-3">
                        <div class="toolbar ">
                            <label class="ui-check m-0 ">
                                <input type="checkbox" class="selectchkAll" id="chk_all" value="0">
                                <i></i>
                            </label>
                            <form class="flex">
                                <div class="input-group">
                                    <input type="text" class="form-control form-control-theme form-control-sm search" placeholder="Search" required>
                                    <span class="input-group-append">
                                        <button class="btn btn-white no-border btn-sm" type="button">
                                            <span class="d-flex text-muted"><i data-feather="search"></i></span>
                                        </button>
                                    </span>
                                </div>
                            </form>
                            <div class="btn-group">
                                @*<button disabled class="btn btn-sm btn-icon btn-white" data-toggle="tooltip" title="Print .pdf" id="btn-print">
                                        <i data-feather="printer"></i>
                                    </button>*@
                                <button disabled class="btn btn-sm btn-icon btn-white" data-toggle="tooltip" title="Export to .xlsx or .csv" id="btn-export">
                                    <i data-feather="save"></i>
                                </button>
                                <button disabled class="btn btn-sm btn-icon btn-white" data-toggle="tooltip" title="Download Images" id="btn-images">
                                    <i data-feather="image"></i>
                                </button>
                            </div>
                            <button data-toggle="modal" data-target="#content-aside" data-modal class="btn btn-sm btn-icon btn-white d-md-none">
                                <i data-feather="menu"></i>
                            </button>
                        </div>
                    </div>
                    <div class="scroll-y mx-3 mb-0 card">

                        <table id="datatable2" class="table table-theme table-row v-middle">
                            <thead>
                                <tr>
                                    <th><span class="text-muted">ID</span></th>
                                    <th><span class="text-muted">STORE</span></th>
                                    <th><span class="text-muted">CUSTOMER</span></th>
                                    <th><span class="text-muted">BRAND</span></th>
                                    <th><span class="text-muted">USER ASSIGNED</span></th>
                                    <th><span class="text-muted">DATE</span></th>
                                    <th><span class="text-muted">CHECK IN</span></th>
                                    <th><span class="text-muted">CHECK OUT</span></th>
                                    <th><span class="text-muted">STATUS</span></th>
                                    <th><span class="text-muted">ACTIONS</span></th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model)
                                {
                                    <tr class=" " data-id="@item.ID_demo">
                                        <td style="min-width:30px;text-align:center">
                                            <small class="text-muted">@item.ID_demo</small>
                                        </td>
                                        <td class="flex">
                                            <a href="#" class="item-title text-color ">@item.ID_Store | @item.store</a>
                                            <div class="item-except text-muted text-sm h-1x">
                                                @item.address , @item.city , @item.state , @item.zipcode
                                            </div>
                                        </td>
                                        <td>@item.vendor</td>
                                        <td>@item.Brands</td>
                                        <td>@item.UserName</td>
                                        <td>@item.visit_date</td>
                                        <td>@item.check_in</td>
                                        <td>@item.end_date</td>
                                        <td>

                                            @if (item.ID_demostate == 1)
                                            {
                                                <span style="font-size:9px;" class="badge badge-danger text-uppercase">Canceled</span>
                                            }
                                            else if (item.ID_demostate == 2)
                                            {
                                                <span style="font-size:9px;" class="badge badge-success text-uppercase">In progress</span>
                                            }
                                            else if (item.ID_demostate == 3)
                                            {
                                                <span style="font-size:9px;" class="badge badge-warning text-uppercase">On Hold</span>
                                            }
                                            else if (item.ID_demostate == 4)
                                            {
                                                <span style="font-size:9px;" class="badge badge-info text-uppercase">Finished</span>
                                            }

                                        </td>
                                        <td>

                                            <a class="btn btn-icons btn-rounded btn-outline-info" href="@Url.Action("Demo_preview", "VisitsMs", new { id = item.ID_demo })" target="_blank"><i class="" data-feather="printer"></i></a>
                                            <button type="button" class="btn btn-icons btn-rounded btn-outline-danger" data-toggle="modal" data-target="#deleteModal"><i class="" data-feather="delete"></i></button>
                                        </td>
                                    </tr>
                                }
                            </tbody>

                        </table>
                    </div>
                </div>
            </div>
            <div class="fade aside aside-sm" id="content-aside">
                <div class="modal-dialog d-flex flex-column w-md bg-body" id="mail-nav">

                    <div class="scrollable hover">
                        <div class="p-2 px-3">
                            <span class=" box-shadows btn-rounded gd-danger" id="btn-new-mail">
                                Hint:
                            </span>
                        </div>
                        <div class="sidenav my-3">
                            <blockquote class="bg-white bg-primary--lt p-3 r">
                                <em>Select at least one activity from the table to download information.</em>
                            </blockquote>
                            @*<div class="card" id="feed-2">
                                    <div class="card-header d-flex">

                                        <div class="mx-3">
                                            <a href="#">Jacqueline Reid</a>

                                        </div>
                                    </div>
                                    <div class="card-body">

                                        <div class="row row-xs">
                                            <div class="col-4">
                                                <div class="media media-4x3 r ">
                                                    <a class="media-content" style="background-image: url(../assets/img/b4.jpg);"></a>
                                                </div>
                                            </div>
                                            <div class="col-4">
                                                <div class="media media-4x3 r ">
                                                    <a class="media-content" style="background-image: url(../assets/img/b8.jpg);"></a>
                                                </div>
                                            </div>
                                            <div class="col-4">
                                                <div class="media media-4x3 r ">
                                                    <a class="media-content" style="background-image: url(../assets/img/b14.jpg);"></a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                </div>*@
                            <nav class="nav-active-text-primary">
                                <ul class="nav">
                                    <li>
                                        <a href="#inbox">
                                            <span class="nav-icon">
                                                <i data-feather="archive"></i>
                                            </span>
                                            <span class="nav-text">All</span>
                                            <span class="nav-badge">
                                                <b class="badge badge-pill gd-warning">@ViewBag.countdemos</b>
                                            </span>
                                        </a>
                                    </li>
                                    @foreach (var vendor in ViewBag.distinctVendor)
                                    {

                                        <li>
                                            <a href="#@vendor.id">
                                                <span class="nav-icon">
                                                    <i data-feather="file"></i>
                                                </span>
                                                <span class="nav-text">@vendor.name</span>
                                                <span class="nav-badge">
                                                    <b class="badge badge-pill gd-success">@vendor.count</b>
                                                </span>
                                            </a>
                                        </li>
                                    }


                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <!-- ############ Main START-->
    <!-- ############ Main END-->
</div>

<!-- .modal -->
<div id="modal-backdrop-dark" class="modal fade" data-backdrop="false">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header ">
                <div class="modal-title text-md">Preview report</div>
                <button class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="DisplayPDF">
                    <embed style="width:100%;height:700px; overflow:hidden" id="previewEmbed" />
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-light" data-dismiss="modal">Close</button>

            </div>
        </div>
        <!-- /.modal-content -->
    </div>
</div>
<!-- / .modal -->
<!--CRESTE USER DATA STARTS-->
<div class="modal fade" id="createModal" role="dialog" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            @using (Html.BeginForm("CreateActivityDemo", "VisitsMs", FormMethod.Post))
            {
                @Html.AntiForgeryToken()
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel-4"><i class="mdi mdi-file-cloud"></i> Add New activity</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span style="font-size: 40px" aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <input type="text" id="ID_visita" name="ID_visita" hidden value="@ViewBag.idvisita" />
                    <div class="col-12 grid-margin">
                        <div class="card">
                            <div class="card-body">

                                <p class="card-description">
                                    <h4 class="card-title">Activity</h4>
                                </p>
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="form-group row">
                                            <select id="ID_form" name="ID_form" class="form-control" style="width:100%">
                                                <option value="0">Select an activity</option>
                                                <optgroup label="Demos">
                                                    @foreach (var form in ViewBag.activeforms)
                                                    {
                                                        if (form.ID_activity == 4)
                                                        {
                                                            <option value="@form.ID_form">@form.name</option>
                                                        }
                                                    }
                                                </optgroup>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <p class="card-description">
                                    <h4 class="card-title" id="demotimetitle">Customer</h4>
                                </p>
                                <div class="row" id="demotimediv">
                                    <div class="col-md-12">
                                        <div class="form-group row">
                                            <select name="ID_customer" id="ID_customer" class="form-control" style="width:100%">
                                                <option id="0">Select a customer</option>
                                                <optgroup label="Sales Representatives">

                                                    @foreach (var store in ViewBag.stores)
                                                    {

                                                        <option value="@store.CardCode">@store.CardName</option>
                                                    }
                                                </optgroup>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <p class="card-description">
                                    <h4 class="card-title" id="demotimetitle">Set start date</h4>
                                </p>
                                <div class="row" id="demotimediv">
                                    <div class="col-md-12">
                                        <div class="form-group row">
                                            <input type="datetime-local" class="form-control" name="time" id="time" />
                                        </div>
                                    </div>
                                </div>

                                <p class="card-description">
                                    <h4 class="card-title">Representative</h4>
                                </p>
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="form-group row">
                                            <select name="ID_rep" id="ID_rep" class="form-control" style="width:100%" onChange='getCustomers()'>
                                                <option id="0">Select a representative</option>
                                                <optgroup label="Sales Representatives">

                                                    @foreach (var rep in ViewBag.representatives)
                                                    {

                                                        <option value="@rep.ID_usuario">@rep.nombre @rep.apellido</option>
                                                    }
                                                </optgroup>
                                                <optgroup label="Demos Representatives">

                                                    @foreach (var rep2 in ViewBag.reps_demos)
                                                    {

                                                        <option value="@rep2.ID">@rep2.name</option>
                                                    }
                                                </optgroup>

                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <p class="card-description">
                                    <h4 class="card-title">Vendor</h4>
                                </p>
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="form-group row">
                                            <select name="ID_vendor" id="ID_vendor" class="form-control" style="width:100%"></select>
                                        </div>
                                    </div>
                                </div>



                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-info">Add</button>
                    <button type="button" class="btn btn-light" data-dismiss="modal">Cancel</button>
                </div>
            }
        </div>
    </div>
</div>
<!--CREATE DEMO DATA ENDS-->
<!--DELETE DATA STARTS-->
<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            @using (Html.BeginForm("DeleteActivity", "VisitsMs", FormMethod.Post))
            {
                @Html.AntiForgeryToken()
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel-4"><i class="mdi mdi-delete"></i> Delete Activity Data</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span style="font-size: 40px" aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">

                    <div class="form-group">
                        <label class="col-form-label">Are you sure you want to delete this activity?</label><br />
                        <strong><label id="descriptionD" class="col-form-label"></label></strong>
                        <input type="text" id="ID_activityD" name="ID_activityD" hidden />
                        <input type="text" id="ID_visitA" name="ID_visitA" value="@ViewBag.idvisita" hidden />
                    </div>


                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-danger">Delete</button>
                    <button type="button" class="btn btn-light" data-dismiss="modal">Cancel</button>
                </div>
            }
        </div>
    </div>
</div>


@Html.Partial("~/Views/Shared/FilterControlAdmin.cshtml")